---
import BaseLayout from '@layouts/BaseLayout.astro';
import DevDashboard from '@components/DevDashboard';
import '@styles/dev-dashboard.css';

export const prerender = false;

// Get authentication details from Clerk
// Note: This page is protected by middleware, so user should be authenticated
let userId: string | null = null;
try {
  const auth = (Astro.locals as any).auth();
  userId = auth?.userId || null;
} catch (error) {
  console.error('Error getting user info:', error);
}

// Redirect to sign-in if not authenticated (fallback check)
if (!userId) {
  return Astro.redirect('/sign-in');
}
---

<BaseLayout title="Developer Dashboard - Keep Choosing Good" description="System information and troubleshooting tools">
  <DevDashboard client:load />
</BaseLayout>

<style is:global>
  /* Override base layout styles for dev dashboard */
  body {
    background: #0f172a;
  }
</style>
