---
import BaseLayout from '@layouts/BaseLayout.astro';
import { UserProfile } from '@clerk/astro/react';

export const prerender = false;

// Get authentication details from Clerk
// Note: This page is protected by middleware, so user should be authenticated
let userId: string | null = null;
try {
  const auth = (Astro.locals as any).auth();
  userId = auth?.userId || null;
} catch (error) {
  console.error('Error getting user info:', error);
}

// Redirect to sign-in if not authenticated (fallback check)
if (!userId) {
  return Astro.redirect('/sign-in');
}
---

<BaseLayout title="Profile - Keep Choosing Good">
  <div class="profile-container">
    <UserProfile
      client:load
      appearance={{
        variables: {
          colorPrimary: '#4f46e5'
        }
      }}
    />
  </div>
</BaseLayout>

<style>
  .profile-container {
    max-width: 900px;
    margin: 0 auto;
    padding: 2rem 1rem;
    display: flex;
    justify-content: center;
  }
</style>
